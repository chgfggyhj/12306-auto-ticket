# 12306火车票自动购买工具

基于Selenium WebDriver实现的12306火车票自动查询和购买工具

## 功能特点

- 自动查询指定日期、车站间的车次信息
- 支持多车次优先级选择
- 自动选择乘车人并提交订单
- 支持cookies持久化，避免重复登录
- 自动处理查询和提交过程中的等待和异常

## 依赖安装

使用前请确保安装以下依赖：

```bash
pip install selenium openpyxl
```

## 使用说明

1. **配置车站代码**
   - 修改`车站代码.xlsx`文件，添加需要的车站名称和代码

2. **获取登录cookies**
   - 运行`获取cookies.py`登录12306并保存cookies到`cookies.pkl`

3. **配置购票参数**
   - 修改`12306.py`中的以下参数：
     ```python
     # 示例配置
     spider('潮汕', '深圳坪山', '2025-05-05', 
           {'D3307':['O','M'], 'D2305':['O','M']}, 
           ['乘车人姓名'])
     ```
   - 参数说明：
     - 前两个参数：出发站和到达站
     - 第三个参数：乘车日期(YYYY-MM-DD格式)
     - 第四个参数：优先车次字典(车次:座位类型列表)
     - 第五个参数：乘车人姓名列表

4. **运行程序**
   ```bash
   python 12306.py
   ```

## 注意事项

1. 请提前通过`获取cookies.py`登录并保存cookies
2. 需要安装Edge浏览器和对应的WebDriver
3. 高峰期抢票时可能需要调整查询频率
4. 程序会自动点击"提交订单"按钮，但最终支付需手动完成
5. 座位类型说明：
   - O: 二等座
   - M: 一等座

## 文件说明

- `12306.py`: 主程序文件
- `获取cookies.py`: 获取登录cookies
- `车站代码.xlsx`: 车站名称与代码对照表
- `cookies.pkl`: 存储登录cookies
- `爬取车站代号.py`: 车站代码爬取工具

## 常见问题

1. 如果出现元素找不到错误，可能是页面结构变化，需要更新XPath
2. 确保WebDriver版本与浏览器匹配
3. 网络不稳定可能导致查询失败，可适当增加等待时间
